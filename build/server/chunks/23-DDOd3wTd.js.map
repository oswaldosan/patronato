{"version":3,"file":"23-DDOd3wTd.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/egresos/_page.server.ts.js","../../../.svelte-kit/adapter-node/nodes/23.js"],"sourcesContent":["import { p as prisma } from \"../../../chunks/db.js\";\nconst load = async ({ url }) => {\n  const page = parseInt(url.searchParams.get(\"page\") || \"1\");\n  const limit = 20;\n  const skip = (page - 1) * limit;\n  const rubroId = url.searchParams.get(\"rubro\") || \"\";\n  const proveedorId = url.searchParams.get(\"proveedor\") || \"\";\n  const desde = url.searchParams.get(\"desde\") || \"\";\n  const hasta = url.searchParams.get(\"hasta\") || \"\";\n  const where = {\n    estado: \"VERIFICADO\"\n  };\n  if (rubroId) {\n    where.rubroId = rubroId;\n  }\n  if (proveedorId) {\n    where.proveedorId = proveedorId;\n  }\n  if (desde || hasta) {\n    where.fecha = {\n      ...desde ? { gte: new Date(desde) } : {},\n      ...hasta ? { lte: /* @__PURE__ */ new Date(hasta + \"T23:59:59\") } : {}\n    };\n  }\n  const [egresosData, totalCount] = await Promise.all([\n    prisma.egreso.findMany({\n      where,\n      include: {\n        rubro: { select: { id: true, nombre: true, color: true } },\n        proveedor: { select: { id: true, nombre: true } }\n      },\n      orderBy: { fecha: \"desc\" },\n      take: limit,\n      skip\n    }),\n    prisma.egreso.count({ where })\n  ]);\n  const egresos = egresosData.map((e) => ({\n    id: e.id,\n    fecha: e.fecha.toISOString(),\n    monto: e.monto.toNumber(),\n    concepto: e.concepto,\n    rubro: e.rubro?.nombre ?? null,\n    rubroColor: e.rubro?.color ?? null,\n    proveedor: e.proveedor?.nombre ?? null,\n    notas: e.notas\n  }));\n  const [rubros, proveedores] = await Promise.all([\n    prisma.rubro.findMany({\n      where: { activo: true },\n      orderBy: { nombre: \"asc\" },\n      select: { id: true, nombre: true }\n    }),\n    prisma.proveedor.findMany({\n      where: { activo: true },\n      orderBy: { nombre: \"asc\" },\n      select: { id: true, nombre: true }\n    })\n  ]);\n  const [totalGeneral, totalPorRubro] = await Promise.all([\n    prisma.egreso.aggregate({\n      _sum: { monto: true },\n      _count: true,\n      where: { estado: \"VERIFICADO\" }\n    }),\n    prisma.egreso.groupBy({\n      by: [\"rubroId\"],\n      _sum: { monto: true },\n      where: { estado: \"VERIFICADO\" }\n    })\n  ]);\n  const rubrosConTotales = await Promise.all(\n    totalPorRubro.map(async (item) => {\n      const rubro = await prisma.rubro.findUnique({\n        where: { id: item.rubroId },\n        select: { nombre: true, color: true }\n      });\n      return {\n        nombre: rubro?.nombre ?? \"Sin categorÃ­a\",\n        color: rubro?.color ?? \"#94a3b8\",\n        total: item._sum.monto?.toNumber() ?? 0\n      };\n    })\n  );\n  rubrosConTotales.sort((a, b) => b.total - a.total);\n  return {\n    egresos,\n    rubros,\n    proveedores,\n    filtros: { rubroId, proveedorId, desde, hasta },\n    stats: {\n      totalGastado: totalGeneral._sum.monto?.toNumber() ?? 0,\n      totalEgresos: totalGeneral._count,\n      porRubro: rubrosConTotales\n    },\n    pagination: {\n      page,\n      limit,\n      total: totalCount,\n      totalPages: Math.ceil(totalCount / limit)\n    }\n  };\n};\nexport {\n  load\n};\n","import * as server from '../entries/pages/egresos/_page.server.ts.js';\n\nexport const index = 23;\nlet component_cache;\nexport const component = async () => component_cache ??= (await import('../entries/pages/egresos/_page.svelte.js')).default;\nexport { server };\nexport const server_id = \"src/routes/egresos/+page.server.ts\";\nexport const imports = [\"_app/immutable/nodes/23.D6rxVvQk.js\",\"_app/immutable/chunks/Bzak7iHL.js\",\"_app/immutable/chunks/CpxVo7Xb.js\",\"_app/immutable/chunks/C1oSKhUs.js\",\"_app/immutable/chunks/6RaR5WWk.js\",\"_app/immutable/chunks/FiqctlaF.js\",\"_app/immutable/chunks/CWn9fQy-.js\",\"_app/immutable/chunks/C2yMkv0y.js\",\"_app/immutable/chunks/BVEhXgIt.js\",\"_app/immutable/chunks/XiZwx-Ce.js\",\"_app/immutable/chunks/DwYBmEoc.js\",\"_app/immutable/chunks/CQlYeRKf.js\",\"_app/immutable/chunks/C6qXeb9M.js\",\"_app/immutable/chunks/DlNLqZHT.js\",\"_app/immutable/chunks/B_TJrAGS.js\",\"_app/immutable/chunks/Dj1_M-cw.js\",\"_app/immutable/chunks/Dp-_RygU.js\",\"_app/immutable/chunks/BHkW5Tdc.js\",\"_app/immutable/chunks/DJc31okB.js\"];\nexport const stylesheets = [];\nexport const fonts = [];\n"],"names":[],"mappings":"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"}