import"../chunks/Bzak7iHL.js";import{d as ge,p as ce,aL as ye,g as e,j as c,f as ne,t as x,a as u,b as ue,k as p,u as re,e as o,s,n as oe,r as l,l as T,i as Q,D as se,h as O,c as we,q as ke,m as Ee,$ as De}from"../chunks/CpxVo7Xb.js";import{i as C}from"../chunks/C1oSKhUs.js";import{e as pe,i as be}from"../chunks/6RaR5WWk.js";import{h as Ie}from"../chunks/FiqctlaF.js";import{a as Ce,e as Oe}from"../chunks/DwtWQrsL.js";import{r as le,s as ie,a as me}from"../chunks/CWn9fQy-.js";import{s as de}from"../chunks/Dj1_M-cw.js";import{b as Ae}from"../chunks/XiZwx-Ce.js";import{b as ve}from"../chunks/D-QOQs1b.js";import{p as $}from"../chunks/Dp-_RygU.js";var Ne=p('<input type="text" placeholder="Buscar..." class="input w-full pr-10" autocomplete="off"/>'),Te=p('<span class="text-slate-500"> </span>'),qe=p('<span class="block truncate"> <!></span>'),Re=p('<span class="block truncate"> </span>'),Se=p('<button type="button"><!></button>'),je=p('<li class="px-4 py-3 text-sm text-slate-500 text-center">No se encontraron resultados</li>'),Be=p('<span class="block text-xs text-slate-500 truncate"> </span>'),Le=p('<li role="option" tabindex="-1"><span class="block font-medium truncate"> </span> <!></li>'),Me=p('<ul class="absolute z-50 w-full mt-1 bg-white border border-slate-200 rounded-xl shadow-lg max-h-60 overflow-auto" role="listbox"><!></ul>'),Ve=p('<div class="combobox-container relative"><input type="hidden"/> <div class="relative"><!> <span class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"><svg class="w-5 h-5 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></span></div> <!></div> <!>',1);function Fe(ee,i){ce(i,!0);let _=$(i,"value",15,""),J=$(i,"placeholder",3,"Seleccionar...");$(i,"required",3,!1);let L=$(i,"disabled",3,!1),f=T(""),g=T(!1),b=T(0),q=T(null),E=T(null);const A=re(()=>i.options.find(a=>a.value===_())),h=re(()=>e(f).trim()===""?i.options:i.options.filter(a=>a.label.toLowerCase().includes(e(f).toLowerCase())||a.sublabel&&a.sublabel.toLowerCase().includes(e(f).toLowerCase())));ye(()=>{e(h).length>0&&c(b,0)});function M(){L()||(c(g,!0),c(f,""))}function D(){c(g,!1),c(f,"")}function V(a){_(a.value),D()}function R(a){if(!e(g)){(a.key==="ArrowDown"||a.key==="ArrowUp"||a.key==="Enter"||a.key===" ")&&(a.preventDefault(),M());return}switch(a.key){case"ArrowDown":a.preventDefault(),c(b,Math.min(e(b)+1,e(h).length-1),!0),F();break;case"ArrowUp":a.preventDefault(),c(b,Math.max(e(b)-1,0),!0),F();break;case"Enter":a.preventDefault(),e(h)[e(b)]&&V(e(h)[e(b)]);break;case"Escape":a.preventDefault(),D();break;case"Tab":D();break}}function F(){if(e(E)){const a=e(E).children[e(b)];a&&a.scrollIntoView({block:"nearest"})}}function W(a){setTimeout(()=>{const t=a.relatedTarget;t!=null&&t.closest(".combobox-container")||D()},150)}var S=Ve(),j=ne(S),I=o(j);le(I);var N=s(I,2),P=o(N);{var U=a=>{var t=Ne();le(t),ve(t,y=>c(q,y),()=>e(q)),Q("keydown",t,R),se("blur",t,W),Ae(t,()=>e(f),y=>c(f,y)),u(a,t)},X=a=>{var t=Se(),y=o(t);{var n=r=>{var v=qe(),w=o(v),ae=s(w);{var k=B=>{var m=Te(),G=o(m);l(m),x(()=>O(G,`(${e(A).sublabel??""})`)),u(B,m)};C(ae,B=>{e(A).sublabel&&B(k)})}l(v),x(()=>O(w,`${e(A).label??""} `)),u(r,v)},d=r=>{var v=Re(),w=o(v,!0);l(v),x(()=>O(w,J())),u(r,v)};C(y,r=>{e(A)?r(n):r(d,!1)})}l(t),x(()=>{t.disabled=L(),de(t,1,`input w-full text-left pr-10 ${L()?"opacity-50 cursor-not-allowed":"cursor-pointer"} ${e(A)?"":"text-slate-400"}`)}),Q("click",t,M),Q("keydown",t,R),u(a,t)};C(P,a=>{e(g)?a(U):a(X,!1)})}oe(2),l(N);var H=s(N,2);{var Y=a=>{var t=Me(),y=o(t);{var n=r=>{var v=je();u(r,v)},d=r=>{var v=we(),w=ne(v);pe(w,17,()=>e(h),be,(ae,k,B)=>{var m=Le(),G=o(m),fe=o(G,!0);l(G);var _e=s(G,2);{var he=K=>{var te=Be(),xe=o(te,!0);l(te),x(()=>O(xe,e(k).sublabel)),u(K,te)};C(_e,K=>{e(k).sublabel&&K(he)})}l(m),x(()=>{ie(m,"aria-selected",e(k).value===_()),de(m,1,`px-4 py-2.5 cursor-pointer transition-colors ${B===e(b)?"bg-primary-50":""} ${e(k).value===_()?"bg-primary-100 text-primary-900":"text-slate-700 hover:bg-slate-50"}`),O(fe,e(k).label)}),se("mouseenter",m,()=>c(b,B,!0)),Q("click",m,()=>V(e(k))),Q("keydown",m,K=>{K.key==="Enter"&&V(e(k))}),u(ae,m)}),u(r,v)};C(y,r=>{e(h).length===0?r(n):r(d,!1)})}l(t),ve(t,r=>c(E,r),()=>e(E)),u(a,t)};C(H,a=>{e(g)&&a(Y)})}l(j);var z=s(j,2);{var Z=a=>{};C(z,a=>{e(g)&&a(Z)})}x(()=>{ie(I,"name",i.name),me(I,_())}),u(ee,S),ue()}ge(["keydown","click"]);var Pe=p('<div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm"> </div>'),Ue=p("<option> </option>"),He=p('<div class="max-w-2xl mx-auto"><div class="mb-8"><a href="/admin/aportes" class="text-sm text-slate-600 hover:text-primary-600 mb-2 inline-block">← Volver a aportes</a> <h1 class="page-title">Registrar Aporte</h1></div> <!> <form method="POST" class="card p-6 space-y-6"><div><label for="donanteId" class="label">Donante *</label> <!> <p class="text-xs text-slate-500 mt-1">¿Donante nuevo? <a href="/admin/donantes/nuevo" class="text-primary-600 hover:underline">Crear primero</a></p></div> <div><label for="rubroId" class="label">Rubro / Categoría *</label> <select id="rubroId" name="rubroId" class="select" required=""><option>Seleccionar rubro...</option><!></select></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><div><label for="fecha" class="label">Fecha *</label> <input type="date" id="fecha" name="fecha" class="input" required=""/></div> <div><label for="monto" class="label">Monto *</label> <input type="number" id="monto" name="monto" step="0.01" min="0.01" class="input" placeholder="0.00" required=""/></div></div> <div><label for="metodo" class="label">Método de pago *</label> <select id="metodo" name="metodo" class="select" required=""><option>Depósito Bancario</option><option>Transferencia</option><option>Efectivo</option><option>Cheque</option><option>Otro</option></select></div> <div><label for="referencia" class="label">Número de referencia <span class="text-slate-400 font-normal">(privado)</span></label> <input type="text" id="referencia" name="referencia" class="input" placeholder="Ej: Número de depósito, boleta, etc."/></div> <div><label for="comentario" class="label">Comentario</label> <textarea id="comentario" name="comentario" rows="2" class="input" placeholder="Notas adicionales..."></textarea></div> <div><label for="estado" class="label">Estado inicial</label> <select id="estado" name="estado" class="select"><option>Pendiente de verificación</option><option>Verificado</option></select></div> <div class="flex justify-end gap-3 pt-4 border-t border-slate-200"><a href="/admin/aportes" class="btn btn-secondary">Cancelar</a> <button type="submit" class="btn btn-primary"> </button></div></form></div>');function aa(ee,i){ce(i,!0);let _=T(!1),J=T(ke(i.data.preselectedDonante||""));const L=re(()=>i.data.donantes.map(n=>({value:n.id,label:n.nombreNegocio||n.nombre,sublabel:n.nombreNegocio?n.nombre:void 0})));var f=He();Ie("je07ob",n=>{Ee(()=>{De.title="Nuevo Aporte - Admin"})});var g=s(o(f),2);{var b=n=>{var d=Pe(),r=o(d,!0);l(d),x(()=>O(r,i.form.error)),u(n,d)};C(g,n=>{var d;(d=i.form)!=null&&d.error&&n(b)})}var q=s(g,2),E=o(q),A=s(o(E),2);Fe(A,{name:"donanteId",get options(){return e(L)},placeholder:"Buscar donante...",required:!0,get value(){return e(J)},set value(n){c(J,n,!0)}}),oe(2),l(E);var h=s(E,2),M=s(o(h),2),D=o(M);D.value=D.__value="";var V=s(D);pe(V,17,()=>i.data.rubros,be,(n,d)=>{var r=Ue(),v=o(r,!0);l(r);var w={};x(()=>{O(v,e(d).nombre),w!==(w=e(d).id)&&(r.value=(r.__value=e(d).id)??"")}),u(n,r)}),l(M),l(h);var R=s(h,2),F=o(R),W=s(o(F),2);le(W),l(F),oe(2),l(R);var S=s(R,2),j=s(o(S),2),I=o(j);I.value=I.__value="DEPOSITO";var N=s(I);N.value=N.__value="TRANSFERENCIA";var P=s(N);P.value=P.__value="EFECTIVO";var U=s(P);U.value=U.__value="CHEQUE";var X=s(U);X.value=X.__value="OTRO",l(j),l(S);var H=s(S,6),Y=s(o(H),2),z=o(Y);z.value=z.__value="PENDIENTE";var Z=s(z);Z.value=Z.__value="VERIFICADO",l(Y),l(H);var a=s(H,2),t=s(o(a),2),y=o(t,!0);l(t),l(a),l(q),Ce(q,(n,d)=>{var r;return(r=Oe)==null?void 0:r(n,d)},()=>()=>(c(_,!0),async({update:n})=>{c(_,!1),await n()})),l(f),x(n=>{me(W,n),t.disabled=e(_),O(y,e(_)?"Guardando...":"Registrar Aporte")},[()=>new Date().toISOString().split("T")[0]]),u(ee,f),ue()}export{aa as component};
