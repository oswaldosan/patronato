import"../chunks/Bzak7iHL.js";import{d as Lt,p as It,l as H,q as st,t as m,g as t,i as ot,a as n,b as Bt,m as Nt,e,s as i,j as K,k as _,$ as qt,r as a,h as p,f as zt,n as Ft,o as j}from"../chunks/CpxVo7Xb.js";import{i as g}from"../chunks/C1oSKhUs.js";import{e as Q,i as W}from"../chunks/6RaR5WWk.js";import{h as Jt}from"../chunks/FiqctlaF.js";import{s as Mt}from"../chunks/CWn9fQy-.js";import{s as X}from"../chunks/Dj1_M-cw.js";import{b as nt}from"../chunks/DwYBmEoc.js";import{g as Ot}from"../chunks/CQlYeRKf.js";import{B as Vt}from"../chunks/DlNLqZHT.js";import{E as Gt}from"../chunks/88GCis-0.js";import{d as Ht}from"../chunks/DJc31okB.js";var Kt=_("<option> </option>"),Qt=_('<div><p class="text-xs font-medium text-slate-500 mb-2">Datos anteriores</p> <pre class="text-xs bg-white p-3 rounded-lg border border-slate-200 overflow-auto max-h-60"> </pre></div>'),Wt=_('<div><p class="text-xs font-medium text-slate-500 mb-2">Datos nuevos</p> <pre class="text-xs bg-white p-3 rounded-lg border border-slate-200 overflow-auto max-h-60"> </pre></div>'),Xt=_("<p> </p>"),Yt=_('<div class="px-4 pb-4 border-t border-slate-100 bg-slate-50"><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"><!> <!></div> <div class="mt-4 text-xs text-slate-500"><p> </p> <!></div></div>'),Zt=_('<div class="card overflow-hidden"><button class="w-full p-4 flex items-center gap-4 hover:bg-slate-50 transition-colors text-left"><div><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 flex-wrap"><!> <span class="font-medium text-slate-900"> </span> <span class="text-xs text-slate-400 font-mono"> </span></div> <p class="text-sm text-slate-500 mt-1"> </p></div> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div>'),$t=_("<a></a>"),ta=_('<div class="flex justify-center gap-2"></div>'),aa=_('<div class="space-y-2"></div> <!>',1),ea=_('<div class="space-y-6"><div><h1 class="page-title">Registro de Auditor√≠a</h1> <p class="text-slate-600 mt-1"> </p></div> <div class="card p-4"><div class="flex flex-col sm:flex-row gap-4"><select class="select flex-1"><option>Todas las entidades</option><!></select> <select class="select w-full sm:w-40"><option>Todas las acciones</option><option>Crear</option><option>Actualizar</option><option>Eliminar</option></select> <button class="btn btn-primary">Filtrar</button></div></div> <!></div>');function ma(vt,l){It(l,!0);let w=H(st(l.data.filtros.entity)),y=H(st(l.data.filtros.action)),P=H(null);const lt={CREATE:"Crear",UPDATE:"Actualizar",DELETE:"Eliminar"},dt={CREATE:"success",UPDATE:"info",DELETE:"danger"};function ct(){const s=new URLSearchParams;t(w)&&s.set("entity",t(w)),t(y)&&s.set("action",t(y)),Ot(`/admin/auditoria?${s.toString()}`)}function pt(s){K(P,t(P)===s?null:s,!0)}var S=ea();Jt("tqjeeb",s=>{Nt(()=>{qt.title="Auditor√≠a - Admin"})});var U=e(S),Y=i(e(U),2),_t=e(Y);a(Y),a(U);var L=i(U,2),Z=e(L),k=e(Z),I=e(k);I.value=I.__value="";var ft=i(I);Q(ft,17,()=>l.data.entities,W,(s,b)=>{var f=Kt(),z=e(f,!0);a(f);var R={};m(()=>{p(z,t(b)),R!==(R=t(b))&&(f.value=(f.__value=t(b))??"")}),n(s,f)}),a(k);var C=i(k,2),B=e(C);B.value=B.__value="";var N=i(B);N.value=N.__value="CREATE";var q=i(N);q.value=q.__value="UPDATE";var $=i(q);$.value=$.__value="DELETE",a(C);var mt=i(C,2);a(Z),a(L);var ut=i(L,2);{var xt=s=>{Gt(s,{title:"Sin registros",description:"No hay actividad registrada con los filtros seleccionados.",icon:"üìã"})},gt=s=>{var b=aa(),f=zt(b);Q(f,21,()=>l.data.logs,W,(A,r)=>{var D=Zt(),T=e(D),u=e(T),h=e(u);{var bt=o=>{var v=j("+");n(o,v)},ht=o=>{var v=j("‚úé");n(o,v)},Et=o=>{var v=j("√ó");n(o,v)};g(h,o=>{t(r).action==="CREATE"?o(bt):t(r).action==="UPDATE"?o(ht,1):o(Et,!1)})}a(u);var F=i(u,2),J=e(F),tt=e(J);Vt(tt,{get variant(){return dt[t(r).action]},children:(o,v)=>{Ft();var E=j();m(()=>p(E,lt[t(r).action])),n(o,E)},$$slots:{default:!0}});var M=i(tt,2),wt=e(M,!0);a(M);var at=i(M,2),yt=e(at,!0);a(at),a(J);var et=i(J,2),At=e(et);a(et),a(F);var Dt=i(F,2);a(T);var Tt=i(T,2);{var Pt=o=>{var v=Yt(),E=e(v),rt=e(E);{var kt=d=>{var c=Qt(),x=i(e(c),2),V=e(x,!0);a(x),a(c),m(G=>p(V,G),[()=>JSON.stringify(t(r).oldData,null,2)]),n(d,c)};g(rt,d=>{t(r).oldData&&d(kt)})}var Ct=i(rt,2);{var Rt=d=>{var c=Wt(),x=i(e(c),2),V=e(x,!0);a(x),a(c),m(G=>p(V,G),[()=>JSON.stringify(t(r).newData,null,2)]),n(d,c)};g(Ct,d=>{t(r).newData&&d(Rt)})}a(E);var it=i(E,2),O=e(it),jt=e(O);a(O);var St=i(O,2);{var Ut=d=>{var c=Xt(),x=e(c);a(c),m(()=>p(x,`IP: ${t(r).ip??""}`)),n(d,c)};g(St,d=>{t(r).ip&&d(Ut)})}a(it),a(v),m(()=>p(jt,`ID completo: ${t(r).id??""}`)),n(o,v)};g(Tt,o=>{t(P)===t(r).id&&o(Pt)})}a(D),m((o,v)=>{X(u,1,`w-10 h-10 rounded-full flex items-center justify-center ${t(r).action==="CREATE"?"bg-green-100 text-green-600":t(r).action==="UPDATE"?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"}`),p(wt,t(r).entity),p(yt,o),p(At,`${t(r).user??""} ‚Ä¢ ${v??""}`),X(Dt,0,`w-5 h-5 text-slate-400 transition-transform ${t(P)===t(r).id?"rotate-180":""}`)},[()=>t(r).entityId.slice(-8),()=>Ht(t(r).createdAt)]),ot("click",T,()=>pt(t(r).id)),n(A,D)}),a(f);var z=i(f,2);{var R=A=>{var r=ta();Q(r,21,()=>Array(Math.min(l.data.pagination.totalPages,10)),W,(D,T,u)=>{var h=$t();h.textContent=u+1,m(()=>{Mt(h,"href",`/admin/auditoria?page=${u+1}&entity=${t(w)??""}&action=${t(y)??""}`),X(h,1,`w-10 h-10 rounded-lg flex items-center justify-center ${l.data.pagination.page===u+1?"bg-primary-600 text-white":"bg-white border border-slate-200 hover:bg-slate-50"}`)}),n(D,h)}),a(r),n(A,r)};g(z,A=>{l.data.pagination.totalPages>1&&A(R)})}n(s,b)};g(ut,s=>{l.data.logs.length===0?s(xt):s(gt,!1)})}a(S),m(()=>p(_t,`${l.data.pagination.total??""} registro${l.data.pagination.total!==1?"s":""} de actividad`)),nt(k,()=>t(w),s=>K(w,s)),nt(C,()=>t(y),s=>K(y,s)),ot("click",mt,ct),n(vt,S),Bt()}Lt(["click"]);export{ma as component};
